---
title: Styling guidelines for ruby by Shopify,Airbnb, and Github
date: "2020-08-12T22:12:03.284Z"
description: "The best guidelines style for ruby suggested by big companies like Shopify, Airbnb, and Github"
category: Rails Refactoring
image: /posts/styling-guidelines-for-ruby-by-shopify-airbnb-and-github/cover.gif
---

<span style={{ color: '#f9beac', letterSpacing: '0.09em', fontSize: '30px', fontWeight: '600' }}>When</span> we come to the term of best practice or best guidance, we properly follow the experts in that field. As a <span style={{ color: '#9b111e', letterSpacing: '0.09em', fontSize: '15px', fontWeight: '600' }}>Ruby</span> developer, my experts are the seniors in big companies like [<span style={{ color: '#9b111e', letterSpacing: '0.09em', fontSize: '15px', fontWeight: '600' }}>Github</span>](https://github.com/github), [<span style={{ color: '#9b111e', letterSpacing: '0.09em', fontSize: '15px', fontWeight: '600' }}>Airbnb</span>](https://github.com/airbnb/), and [<span style={{ color: '#9b111e', letterSpacing: '0.09em', fontSize: '15px', fontWeight: '600' }}>Shopify</span>](https://github.com/Shopify/) who are using <span style={{ color: '#9b111e', letterSpacing: '0.09em', fontSize: '15px', fontWeight: '600' }}>Ruby</span> as the main language and they're the largest companies for <span style={{ color: '#9b111e', letterSpacing: '0.09em', fontSize: '15px', fontWeight: '600' }}>Ruby</span> out there.

Before we go into <span style={{ color: '#9b111e', letterSpacing: '0.09em', fontSize: '15px', fontWeight: '600' }}>Ruby</span> styles, I would like to encourage you to use [<span style={{ color: '#9b111e', letterSpacing: '0.09em', fontSize: '15px', fontWeight: '600' }}>RuboCop</span>](https://github.com/rubocop-hq/rubocop), the most recommended tool for <span style={{ color: '#9b111e', letterSpacing: '0.09em', fontSize: '15px', fontWeight: '600' }}>Ruby</span> projects. It helps you adopt best practices for <span style={{ color: '#9b111e', letterSpacing: '0.09em', fontSize: '15px', fontWeight: '600' }}>Ruby</span> styling. To know how to install and use RuboCop, please refer to *[RuboCop's official documentation](https://docs.rubocop.org/rubocop/)*.

<span style={{ color: '#f9beac', letterSpacing: '0.09em', fontSize: '30px', fontWeight: '600' }}>Bring your</span> <span style={{ fontSize: '50px' }}>&#9749;</span> <span style={{ color: '#f9beac', letterSpacing: '0.09em', fontSize: '30px', fontWeight: '600' }}>and let's start</span>


# General Coding Style

<dl>
  <dt><span style={{ color: '#f9beac', letterSpacing: '0.09em', fontSize: '30px', fontWeight: '600' }}>Github</span></dt>
  <dd>1) Use soft-tabs with a two space indent.</dd>
  <dd>2) Keep lines fewer than 80 characters.</dd>
  <dd>3) Never leave trailing whitespace.</dd>
  <dd>4) End each file with a blank newline.</dd>
  <dd>5) Use spaces around operators, after commas, colons and semicolons, around {'{'} and before {'}'}.</dd>

  <dt><span style={{ color: '#f9beac', letterSpacing: '0.09em', fontSize: '30px', fontWeight: '600' }}>Shopify</span></dt>
  <dd>1) Make all lines of your methods operate on the same level of abstraction. (Single Level of Abstraction Principle)</dd>
  <dd>2) Code in a functional way. Avoid mutation (side effects) when you can.</dd>
  <dd>3) Do not program defensively. <a href="http://www.erlang.se/doc/programming_rules.shtml#HDR11" target="_top">see</a></dd>
  <dd>4) Do not mutate arguments unless that is the purpose of the method.</dd>
  <dd>5) Do not mess around in / monkeypatch core classes when writing libraries.</dd>
  <dd>6) Keep the code simple.</dd>
  <dd>7) Don't overdesign.</dd>
  <dd>8) Don't underdesign.</dd>
  <dd>9) Avoid bugs.</dd>
  <dd>10) Be consistent.</dd>
  <dd>11) Use common sense.</dd>
</dl>

<dl>
  <dt><span style={{ color: '#f9beac', letterSpacing: '0.09em', fontSize: '30px', fontWeight: '600' }}>Airbnb</span></dt>
  <dd>Nothing <span style={{ fontSize: '30px' }}>&#9997;</span> from Airbnb</dd>
</dl>


# Syntax

<span style={{ color: '#f9beac', letterSpacing: '0.09em', fontSize: '30px', fontWeight: '600' }}>Shopify</span>

- Use :: only to reference constants (this includes classes and modules) and constructors (like Array() or Nokogiri::HTML()). Do not use :: for regular method invocation.
- Avoid using :: for defining classes and modules, or for inheritance, since constant lookup will not search in parent classes/modules.

```ruby
# bad
module A
  FOO = 'test'
end

class A::B
  puts FOO  # this will raise a NameError exception
end

# good
module A
  FOO = 'test'

  class B
    puts FOO
  end
end
```

- Use def with parentheses when there are parameters. Omit the parentheses when the method doesn't accept any parameters.
- Never use for, unless you know exactly why.
- Never use then.
- Favour the ternary operator(?:) over if/then/else/end constructs.

```ruby
# bad
result = if some_condition then something else something_else end

# good
result = some_condition ? something : something_else
```
- Use one expression per branch in a ternary operator. This also means that ternary operators must not be nested. Prefer if/else constructs in these cases.
- Use when x then ... for one-line cases.
- Use ! instead of not.
- Prefer &&/|| over and/or. More info on and/or for control flow.
- Avoid multiline ?: (the ternary operator); use if/unless instead.
- Favour unless over if for negative conditions.
- Do not use unless with else. Rewrite these with the positive case first.
- Use parentheses around the arguments of method invocations. Omit parentheses when not providing arguments. Also omit parentheses when the invocation is single-line and the method:

```ruby
# bad
class User
  include(Bar)
  has_many(:posts)
end

# good
class User
  include Bar
  has_many :posts
  SomeClass.some_method(:foo)
end
```

- Avoid return where not required for control flow.
- Avoid <code>self</code> where not required (it is only required when calling a self write accessor).
- Use ||= to initialize variables only if they're not already initialized.
- Don't use ||= to initialize boolean variables (consider what would happen if the current value happened to be false).

```ruby
# bad - would set enabled to true even if it was false
@enabled ||= true

# good
@enabled = true if enabled.nil?

# also valid - defined? workaround
@enabled = true unless defined?(@enabled)
```
- Do not put a space between a method name and the opening parenthesis.
- Use the new lambda literal syntax.

```ruby
# bad
l = lambda { |a, b| a + b }
l.call(1, 2)

l = lambda do |a, b|
  tmp = a * 7
  tmp * b / 50
end

# good
l = ->(a, b) { a + b }
l.call(1, 2)

l = ->(a, b) do
  tmp = a * 7
  tmp * b / 50
end

```


- Prefer proc over Proc.new
- Prefix with <code> _ </code> unused block parameters and local variables. It's also acceptable to use just <code> _ </code>.




```ruby
# bad
def compute_thing(thing)
  if thing[:foo]
    update_with_bar(thing)
    if thing[:foo][:bar]
      partial_compute(thing)
    else
      re_compute(thing)
    end
  end
end

# good
def compute_thing(thing)
  return unless thing[:foo]
  update_with_bar(thing[:foo])
  return re_compute(thing) unless thing[:foo][:bar]
  partial_compute(thing)
end
```



- Avoid hashes-as-optional-parameters in general. Does the method do too much?
- Prefer keyword arguments over options hash.
- Prefer map over <code>collect</code>, <code>find</code> over <code>detect</code>, <code>select</code> over <code>find_all</code>, <code>size</code> over <code>length</code>.
- Prefer <code>Time</code> over <code>DateTime</code> since it supports proper time zones instead of UTC offsets [ More info](https://gist.github.com/pixeltrix/e2298822dd89d854444b).

<span style={{ color: '#f9beac', letterSpacing: '0.09em', fontSize: '30px', fontWeight: '600' }}>Github</span>

- Use def with parentheses when there are arguments. Omit the parentheses when the method doesn't accept any arguments.

```ruby
  def some_method
      # body omitted
  end

  def some_method_with_arguments(arg1, arg2)
      # body omitted
  end
```
- Never use <code>for</code>, unless you know exactly why. Most of the time iterators should be used instead. <code>for</code> is implemented in terms of <code>each</code> (so you're adding a level of indirection), but with a twist - <code>for</code> doesn't introduce a new scope (unlike <code>each</code>) and variables defined in its block will be visible outside it.


```ruby
  arr = [1, 2, 3]

  # bad
  for elem in arr do
    puts elem
  end

  # good
  arr.each { |elem| puts elem }

```
- Never use then for multi-line if/unless.

```ruby
# bad
if some_condition then
  # body omitted
end

# good
if some_condition
  # body omitted
end
```

- Avoid the ternary operator (?:) except in cases where all expressions are extremely trivial. However, do use the ternary operator(?:) over if/then/else/end constructs for single line conditionals

```ruby
  # bad
  result = if some_condition then something else something_else end

  # good
  result = some_condition ? something : something_else
```

- Use one expression per branch in a ternary operator. This also means that ternary operators must not be nested. Prefer <code>if/else</code> constructs in these cases.


```ruby
  # bad
  some_condition ? (nested_condition ? nested_something : nested_something_else) : something_else

  # good
  if some_condition
    nested_condition ? nested_something : nested_something_else
  else
    something_else
  end
```
- The <code>and</code> and <code>or</code> keywords are banned. It's just not worth it. Always use <code>&&</code> and <code>||</code> instead.
- Avoid multi-line <code>?:</code> (the ternary operator), use <code>if/unless</code> instead.
- Favor modifier <code>if/unless</code> usage when you have a single-line body.



```ruby
  # bad
  if some_condition
    do_something
  end

  # good
  do_something if some_condition
```
- Never use <code>unless</code> with <code>else</code>. Rewrite these with the positive case first

```ruby
# bad
unless success?
  puts "failure"
else
  puts "success"
end

# good
if success?
  puts "success"
else
  puts "failure"
end
```
- Don't use parentheses around the condition of an <code>if/unless/while</code>.


```ruby
# bad
if (x > 10)
  # body omitted
end

# good
if x > 10
  # body omitted
end
```

Prefer <code>{"{...}"}</code> over <code>do...end</code> for single-line blocks. Avoid using <code>{"{...}"}</code> for multi-line blocks (multiline chaining is always ugly). Always use <code>do...end</code> for "control flow" and "method definitions" (e.g., in Rakefiles and certain DSLs). Avoid <code>do...end</code> when chaining.



```ruby
  names = ["Bozhidar", "Steve", "Sarah"]

  # good
  names.each { |name| puts name }

  # bad
  names.each do |name|
    puts name
  end

  # good
  names.select { |name| name.start_with?("S") }.map { |name| name.upcase }

  # bad
  names.select do |name|
    name.start_with?("S")
  end.map { |name| name.upcase }

```

Some will argue that multiline chaining would look OK with the use of <code>{"{...}"}</code>, but they should ask themselves - is this code really readable and can't the block's contents be extracted into nifty methods?

- Avoid return where not required.

```ruby
# bad
def some_method(some_arr)
  return some_arr.size
end

# good
def some_method(some_arr)
  some_arr.size
end
```
- Use spaces around the <code>=</code> operator when assigning default values to method parameters:

```ruby
# bad
def some_method(arg1=:default, arg2=nil, arg3=[])
  # do something...
end

# good
def some_method(arg1 = :default, arg2 = nil, arg3 = [])
  # do something...
end
```

While several Ruby books suggest the first style, the second is much more prominent in practice (and arguably a bit more readable).
